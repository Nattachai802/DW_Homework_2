<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <title>NYC Taxi Trips Dashboard</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f6f9;
        color: #333;
      }

      header {
        background-color: #004080;
        color: white;
        padding: 20px 40px;
        text-align: center;
      }

      main {
        max-width: 900px;
        margin: 40px auto;
        padding: 20px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }

      h1,
      h2 {
        color: #004080;
      }

      pre {
        background-color: #f0f0f0;
        padding: 10px;
        border-radius: 6px;
        overflow-x: auto;
      }

      ul {
        padding-left: 20px;
      }

      footer {
        text-align: center;
        font-size: 0.85em;
        color: #888;
        margin-top: 50px;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>NYC Taxi Trips Dashboard</h1>
      <p>‡πÇ‡∏î‡∏¢ ‡∏ô‡∏≤‡∏¢ ‡∏ì‡∏±‡∏è‡∏ê‡∏ä‡∏±‡∏¢ ‡∏™‡∏µ‡πÉ‡∏™ - 65114540170</p>
    </header>

    <main>
      <h2>üìÅ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</h2>
      <p>
        ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å NYC Taxi Trips Overview ‡πÅ‡∏ó‡∏ô‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Click Logs
        ‡∏Ç‡∏≠‡∏á Criteo ‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
      </p>

      <h2>‚öôÔ∏è ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö</h2>
      <ol>
        <li>‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ClickHouse ‡πÅ‡∏•‡∏∞ Django</li>
        <li>
          ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Virtual Environment ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:
          <pre>
cd homework2
pip install -r requirements.txt</pre
          >
        </li>
      </ol>

      <h2>üíæ ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
      <p>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö ClickHouse ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:</p>
      <pre>./clickhouse client</pre>

      <p>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)</p>
      <pre>
CREATE TABLE nyc_taxi (
    pickup_datetime DateTime,
    dropoff_datetime DateTime,
    passenger_count UInt8,
    trip_distance Float32,
    payment_type String,
    total_amount Float32
) ENGINE = MergeTree()
ORDER BY pickup_datetime;</pre
      >

      <p>‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å S3:</p>
      <pre>
INSERT INTO nyc_taxi
FROM s3(
  'https://datasets-documentation.s3.eu-west-3.amazonaws.com/nyc-taxi/trips_{0..2}.gz',
  'TabSeparatedWithNames'
);</pre
      >

      <h2>üöÄ ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ClickHouse Server</h2>
      <p>‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:</p>
      <pre>./clickhouse server</pre>

      <h2>üîó ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Django (views.py)</h2>
      <p>
        ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå <code>views.py</code> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö ClickHouse
        ‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï:
      </p>
      <pre>
def hw04_view(request):
    client = Client(host='localhost', port='9000', database='nyc_taxi')  # ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö ClickHouse
    query = "SELECT trip_id, pickup_datetime, dropoff_datetime, passenger_count, trip_distance, fare_amount FROM trips_small LIMIT 20"
    
    # ‡∏£‡∏±‡∏ô query ‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    result = client.execute(query)
    
    # ‡πÅ‡∏õ‡∏•‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô dictionary ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á JsonResponse
    data = []
    for row in result:
        data.append({
            "id": row[0],
            "pickup_datetime": row[1],
            "dropoff_datetime": row[2],
            "passenger_count": row[3],
            "trip_distance": row[4],
            "fare_amount": row[5]
        })
    
    return render(request, 'ny_taxi_template.html', {'data': data})</pre
      >

      <h2>üåê ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏î‡πâ‡∏ß‡∏¢ Django</h2>
      <p>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Django Server:</p>
      <pre>python manage.py runserver</pre>
      <p>
        ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏µ‡πà
        <code>http://127.0.0.1:8000</code> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      </p>

      <h2>üìä ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• NYC Taxi Trips (100 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å)</h2>
      <p>(‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ Django Template Loop ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏î‡πâ)</p>
    </main>

    <footer>
      <p>‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡πâ‡∏≤‡∏ô | DW Homework 4</p>
    </footer>
  </body>
</html>
